import SignaturePad from"signature_pad";import mergeImages from"merge-images";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){_defineProperty(a,b,c[b])})}return a}function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_nonIterableSpread()}function _arrayWithoutHoles(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function _iterableToArray(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var SAVE_TYPE=["image/png","image/jpeg","image/svg+xml"],checkSaveType=function(a){return SAVE_TYPE.includes(a)},DEFAULT_OPTIONS={dotSize:3/2,minWidth:.5,maxWidth:2.5,throttle:16,minDistance:5,backgroundColor:"rgba(0,0,0,0)",penColor:"black",velocityFilterWeight:.7,onBegin:function(){},onEnd:function(){}},convert2NonReactive=function(a){return JSON.parse(JSON.stringify(a))},TRANSPARENT_PNG={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkSAMAAGwAaKJgE8oAAAAASUVORK5CYII=",x:0,y:0},VueSignaturePad={name:"VueSignaturePad",props:{width:{type:String,default:"100%"},height:{type:String,default:"100%"},customStyle:{type:Object},saveType:{type:String,default:"image/png"},options:{type:Object,default:function(){return{}}},images:{type:Array,default:function(){return[]}}},data:function(){return{signaturePad:{},cacheImages:[],signatureData:TRANSPARENT_PNG,onResizeHandler:null}},mounted:function(){var a=this.options,b=this.$refs.signaturePadCanvas,c=new SignaturePad(b,_objectSpread({},DEFAULT_OPTIONS,a));this.signaturePad=c,this.onResizeHandler=this.resizeCanvas.bind(this),window.addEventListener("resize",this.onResizeHandler,!1),this.resizeCanvas()},beforeDestroy:function(){this.onResizeHandler&&window.removeEventListener("resize",this.onResizeHandler,!1)},methods:{resizeCanvas:function(){var a=this.$refs.signaturePadCanvas,b=this.signaturePad.toData(),c=Math.max(window.devicePixelRatio||1,1);a.width=a.offsetWidth*c,a.height=a.offsetHeight*c,a.getContext("2d").scale(c,c),this.signaturePad.clear(),this.signatureData=TRANSPARENT_PNG,this.signaturePad.fromData(b)},saveSignature:function(){var a=this.signaturePad,b=this.saveType,c={isEmpty:!1,data:void 0};if(!checkSaveType(b))throw new Error("Image type is incorrect!");return a.isEmpty()?_objectSpread({},c,{isEmpty:!0}):(this.signatureData=a.toDataURL(b),_objectSpread({},c,{data:this.signatureData}))},undoSignature:function(){var a=this.signaturePad,b=a.toData();if(b)return a.fromData(b.slice(0,-1))},mergeImageAndSignature:function(a){return this.signatureData=a,mergeImages([].concat(_toConsumableArray(this.images),_toConsumableArray(this.cacheImages),[this.signatureData]))},addImages:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return this.cacheImages=[].concat(_toConsumableArray(this.cacheImages),_toConsumableArray(a)),mergeImages([].concat(_toConsumableArray(this.images),_toConsumableArray(this.cacheImages),[this.signatureData]))},fromDataURL:function(a){return this.signaturePad.fromDataURL(a)},lockSignaturePad:function(){return this.signaturePad.off()},openSignaturePad:function(){return this.signaturePad.on()},isEmpty:function(){return this.signaturePad.isEmpty()},getPropImagesAndCacheImages:function(){return this.propsImagesAndCustomImages},clearCacheImages:function(){return this.cacheImages=[],this.cacheImages},clearSignature:function(){return this.signaturePad.clear()}},computed:{propsImagesAndCustomImages:function(){var a=convert2NonReactive(this.images),b=convert2NonReactive(this.cacheImages);return[].concat(_toConsumableArray(a),_toConsumableArray(b))}},render:function(a){var b=this.width,c=this.height,d=this.customStyle;return a("div",{style:_objectSpread({width:b,height:c},d)},[a("canvas",{style:{width:"100%",height:"100%"},ref:"signaturePadCanvas"})])}};VueSignaturePad.install=function(a){return a.component(VueSignaturePad.name,VueSignaturePad)},"undefined"!=typeof window&&window.Vue&&window.Vue.use(VueSignaturePad);export default VueSignaturePad;
